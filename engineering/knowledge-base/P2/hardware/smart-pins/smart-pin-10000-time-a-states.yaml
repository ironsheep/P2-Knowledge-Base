# Smart Pin Mode %10000 - Time A-input States
# Source: Silicon Doc v35, part4-smart-pins.txt

mode_id: "%10000"
mode_name: "Time A-input States"
description: "Continuously times both high and low states of A-input in clock cycles"
category: "timing_measurement"
output_override: false

configuration:
  wrpin_format:
    description: "D/# = %AAAA_BBBB_FFF_MMMMMMMMMMMMM_TT_SSSSS_0"
    sssss_value: "%10000"

measurement_operation:
  timing_method: "Continuous state duration counting in clock cycles"
  both_states: "Times both high and low states"
  state_change_trigger: "Measurement completes on each state change"

measurement_output:
  prior_state: "Prior state placed in C-flag buffer"
  duration_count: "Prior state's duration count placed in Z"
  in_signal: "IN raised after each state change"
  reading: "RDPIN/RQPIN retrieves duration measurement"
  limit: "Z limited to $80000000 (prevents overflow)"

continuous_operation:
  measurement_type: "Each state change produces a measurement"
  data_rate: "Measurement rate depends on input signal frequency"
  overwrite_risk: "Fast state changes may overwrite measurements before reading"

dual_pin_solution:
  problem: "Single pin may miss short states due to cog response time"
  solution: "Use two smart pins with one inverting A input"
  benefit: "Capture both high and low states if combined duration allows"
  configuration:
    pin1: "Normal A input (times high states)"
    pin2: "Inverted A input (times low states)" 
    result: "Complete state timing if sum of durations manageable"

instructions:
  setup:
    - "WRPIN - Configure mode (%10000)"
    
  operation:
    - "RDPIN/RQPIN - Read state duration after IN raised"
    - "Check C flag for previous state (high/low)"

reset_behavior:
  during_reset:
    dir_state: "DIR=0"
    in_signal: "IN is low"
    z_register: "Z set to $00000001"

behavior:
  in_signal: "Raised upon each state change"
  c_flag: "Contains previous state information"
  acknowledgment:
    triggers: "WRPIN, WXPIN, WYPIN, RDPIN, AKPIN"
    effect: "Lowers IN signal after 2 clocks"

usage_notes:
  - "Provides complete state timing information"
  - "Both high and low states measured"
  - "Fast state changes may cause measurement loss"
  - "Consider dual-pin approach for complete capture"
  - "Maximum count limited to prevent overflow"

applications:
  pulse_width_analysis: "Measure both pulse and gap widths"
  duty_cycle_measurement: "Calculate duty cycle from state times"
  signal_characterization: "Complete timing analysis of digital signals"
  protocol_analysis: "Timing analysis of communication signals"

measurement_strategy:
  single_pin: "Simple but may miss fast transitions"
  dual_pin: "Complete capture for moderate speeds"
  software_coordination: "Coordinate readings with IN signal timing"

limitations:
  fast_signals: "May lose measurements if state changes faster than cog response"
  overflow_protection: "Count limited to $80000000"
  sequential_reading: "Must read each measurement before next state change"

related_modes:
  - "%10001 (Time A-highs)"
  - "%10010 (Time X A-highs/rises/edges or timeout)"
  - "Period measurement modes"

see_also:
  - "State timing measurement techniques"
  - "Duty cycle calculation methods"
  - "Dual-pin timing strategies"

source:
  document: "Silicon Doc v35"
  section: "Smart Pin Modes"
  page_reference: "part4-smart-pins.txt"
  extraction_date: "2025-09-06"