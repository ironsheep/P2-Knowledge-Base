instruction: DRVRND
syntax: DRVRND {#}Dest {WCZ}
encoding:
- EEEE 1101011 CZL DDDDDDDDD 001011110 DIRx + OUTx Orig OUTx base bit Orig OUTx base bit
- EEEE 1101011 CZL DDDDDDDDD 001011100 DIRx1 + OUTx Orig OUTx base bit Orig OUTx base bit                           2
- EEEE 1101011 CZL DDDDDDDDD 001011101 DIRx1 + OUTx Orig OUTx base bit Orig OUTx base bit                           2
timing:
  cycles: 2
  type: fixed
group: I/O Pin Instruction - Set pin(s) direction to output and output level to random low/high.
description: "DRVRND sets the I/O pin(s) designated by Dest to the output direction and with output level(s)\
  \ set randomly low Result: The I/O pins described by Dest are set to the output direction and each output\
  \ level is set randomly low or high; the rest are left as-is. Z = OUT bit.\n\nDRVRND sets the I/O pin(s)\
  \ designated by Dest to the output direction and with output level(s) set randomly low\n\nand high,\
  \ based on bit(s) from the Xoroshiro128** PRNG. All other pins are left unchanged. This instruction\
  \ can\n\naffect one or more of the bits within the DIRA or DIRB and OUTA or OUTB registers.\n\nDRVRND\
  \ achieves the same effect as two instructions\u2014 OUTRND followed by DIRH.\n\nDest[5:0] indicates\
  \ the pin number (0\u201363). For a range of pins, Dest[5:0] indicates the base pin number (0\u2013\
  63)\n\nand Dest[10:6] indicates how many contiguous pins beyond the base should be affected (1\u2013\
  31).\n\nA 9-bit literal Dest is enough to express the base pin (Dest[5:0]) and a range of up to 8 contiguous\
  \ pins (Dest[8:6]).\n\nIf needed, use the augmented literal feature (##Dest) to augment Dest to an 11-bit\
  \ literal value\u2014 this inserts an\n\nAUGD instruction prior.\n\nWhen Dest is a register, the register's\
  \ value bits [10:0] are used as-is to form the 11-bit ID range, unless a SETQ\n\ninstruction immediately\
  \ precedes the DRVRND instruction; substituting SETQ's Dest[4:0] in place of value\n\nbits[10:6], for\
  \ DRVRND's use.\n\nThe range calculation (from Dest[5:0] up to Dest[5:0]+Dest[10:6]) will wrap within\
  \ the same 32-pin group (DIRA or\n\nDIRB and OUTA or OUTB); it will not cross the port boundary.\n\n\
  If the WCZ effect is speci\uFB01ed, the C and Z \uFB02ags are updated to the original state of OUTA\
  \ / OUTB's base bit,\n\nidenti\uFB01ed by Dest.\n\nDRVZ / DRVNZ\n\nDrive Z or not Z\n\nI/O Pin Instruction\
  \ - Set pin(s) direction to output and output level to low/high according to Z or !Z.\n\nDRVZ      \
  \ {#}Dest {WCZ}\n\nDRVNZ {#}Dest {WCZ}\n\nResult: The I/O pins described by Dest are set to the output\
  \ direction and to an output level of low/high according\n\nto Z or !Z; the rest are left as-is.\n\n\
  \u25CF   Dest is the register, 9-bit literal, or 11-bit augmented literal whose value identi\uFB01es\
  \ the I/O pin(s) to set to\n\noutput direction and output levels of low or high.\n\n\u25CF   WCZ is\
  \ an optional effect to update \uFB02ags.\n\nCOND INSTR            FX     DEST          SRC        \
  \    Write             C Flag             Z Flag              Clocks\n\nEEEE 1101011 CZL DDDDDDDDD 001011100\
  \ DIRx1 + OUTx Orig OUTx base bit Orig OUTx base bit                           2\n\nEEEE 1101011 CZL\
  \ DDDDDDDDD 001011101 DIRx1 + OUTx Orig OUTx base bit Orig OUTx base bit                           2\n\
  \n1\n\nNew DIRx state is not data-forwarded; the next pipelined instruction sees the old state. Make\
  \ sure any instruction that reads\n\nor modi\uFB01es DIRx is at least two instructions after a DRVZ\
  \ or DRVNZ.\n\nDRVZ or DRVNZ sets the I/O pin(s) designated by Dest to the output direction and to a\
  \ low/high output level\n\naccording to the state, or inverse state, of the Z \uFB02ag; i.e. alters\
  \ the pin's direction and output registers. All other\n\npins are left unchanged. Each of these instructions,\
  \ DRVZ and DRVNZ, can affect one or more of the bits within\n\nthe DIRA or DIRB and OUTA or OUTB registers.\n\
  \nDRVZ or DRVNZ achieves the same effect as two instructions\u2014 OUTZ, or OUTNZ, followed by DIRH.\n\
  \nDest[5:0] indicates the pin number (0\u201363). For a range of pins, Dest[5:0] indicates the base\
  \ pin number (0\u201363)\n\nand Dest[10:6] indicates how many contiguous pins beyond the base should\
  \ be affected (1\u201331).\n\nA 9-bit literal Dest is enough to express the base pin (Dest[5:0]) and\
  \ a range of up to 8 contiguous pins (Dest[8:6]).\n\nIf needed, use the augmented literal feature (##Dest)\
  \ to augment Dest to an 11-bit literal value\u2014 this inserts an\n\nAUGD instruction prior.\n\nWhen\
  \ Dest is a register, the register's value bits [10:0] are used as-is to form the 11-bit ID range, unless\
  \ a SETQ\n\ninstruction immediately precedes the DRVZ / DRVNZ instruction; substituting SETQ's Dest[4:0]\
  \ in place of value\n\nbits[10:6], for DRVZ / DRVNZ's use.\n\nThe range calculation (from Dest[5:0]\
  \ up to Dest[5:0]+Dest[10:6]) will wrap within the same 32-pin group (DIRA or\n\nDIRB and OUTA or OUTB);\
  \ it will not cross the port boundary.\n\nIf the WCZ effect is speci\uFB01ed, the C and Z \uFB02ags\
  \ are updated to the original state of OUTA / OUTB's base bit,\n\nidenti\uFB01ed by Dest."
flags_affected:
  Z:
    formula: OUT bit
parameters:
- "Dest is the register, 9-bit literal, or 11-bit augmented literal whose value identi\uFB01es the I/O\
  \ pin(s) to set to the output direction and with output level(s) set randomly to low or high."
- "WCZ is an optional effect to update \uFB02ags."
- "Dest is the register, 9-bit literal, or 11-bit augmented literal whose value identi\uFB01es the I/O\
  \ pin(s) to set to output direction and output levels of low or high."
- "WCZ is an optional effect to update \uFB02ags."
documentation_source: PASM2 Manual 2022/11/01 Pages 31-147
documentation_level: comprehensive
compiler_operand_format:
  name: operand_pinop
  pattern: D/#0..511 {WC/WZ}
  description: 'Pin operation: destination/immediate pin number 0-511, optional effect flags'
  valueType: 30
compiler_encoding:
  operandFormat: 30
enhancement_source: PNUT_TS_v2.0_complete_operand_integration_2025-09-13
last_updated: '2025-09-19'
brief_description: Drive random
category: I/O Pin Instruction - Set pin(s) direction to output and output level to random low/high.
result: The I/O pins described by Dest are set to the output direction and to an output level of low/high
  according
syntax_variants:
- DRVRND {#}Dest {WCZ}
- DRVRND sets the I/O pin(s) designated by Dest to the output direction and with output level(s) set randomly
  low
- instruction immediately precedes the DRVRND instruction; substituting SETQ's Dest[4:0] in place of value
- bits[10:6], for DRVRND's use.
manual_extraction_date: '2025-01-19'
