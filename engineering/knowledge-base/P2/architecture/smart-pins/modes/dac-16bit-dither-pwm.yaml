# Smart Pin Mode: %00011 (DAC_MODE) - DAC 16-bit Dither with PWM
# Silicon Doc Reference: part4-smart-pins.txt, page 86
# Layer 1: Direct Silicon Doc extraction

mode_id: "%00011"

mode_name: "DAC 16-bit Dither with PWM"

mode_group: "dac"

mode_complexity: "advanced"

dac_mode_dependency: true

pin_pairing: "none"

operation_description: |
  DAC 16-bit dither mode with PWM overrides M[7:0] to feed the pin's 8-bit DAC with PWM-dithered
  data. M[12:10] must be %101 for DAC_MODE. X[15:0] establishes sample period (must be multiple
  of 256 with X[7:0]=0) for integral PWM steps. Y[15:0] is DAC output value. PWM dithering gives
  better dynamic range than pseudo-random dithering with only two transitions per 256 clocks,
  but creates Fclock/256 frequency at -48dB.

x_parameter:
  usage: "Sample period (must be multiple of 256)"
  bit_fields:
    - range: "X[15:0]"
      purpose: "Sample period in clocks, X[7:0] must be 0"
      valid_values:
        min: 256
        max: 65280
        special_values:
          - value: 256
            meaning: "Minimum period for PWM dithering"
          - value: 1024
            meaning: "4x PWM period for smoother operation"

y_parameter:
  usage: "16-bit DAC output value"
  bit_fields:
    - range: "Y[15:0]"
      purpose: "DAC output value with PWM dithering"
      valid_values:
        min: 0
        max: 65535

z_result:
  data_type: "16-bit ADC accumulation"
  bit_interpretation:
    - range: "Z[15:0]"
      meaning: "ADC load measurement (if OUT high)"

timing_specifications:
  clock_relationship: "PWM dithering at Fclock/256 rate"
  update_frequency: "Y captured every X[15:0] clocks"

common_applications:
  - application: "High-quality audio DAC"
    description: "16-bit DAC with predictable PWM dithering"
    complexity_level: "expert"
  - application: "Precision voltage reference"
    description: "Low-noise voltage generation"
    complexity_level: "expert"

configuration_examples:
  - name: "Precision 16-bit DAC"
    description: "High-resolution DAC with PWM dithering"
    wrpin_code: "WRPIN ##%0000_0000_000_1010000000000_01_00011_0, precision_dac"
    wxpin_code: "WXPIN #1024, precision_dac"
    wypin_code: "WYPIN dac_value, precision_dac"
    explanation: "PWM dithering with 1024-clock periods"

extraction_metadata:
  extraction_date: "2025-09-06"
  source_documents:
    - document: "Silicon Doc part4-smart-pins.txt"
      pages: [86]
      section: "%00011 and DAC_MODE = DAC 16-bit dither, PWM"
  validation_status: "draft"
  completeness_score: 85
  technical_accuracy: "silicon_doc_verified"