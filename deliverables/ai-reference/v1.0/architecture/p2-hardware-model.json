{
  "$schema": "../schemas/architecture-schema.json",
  "processor": {
    "name": "Parallax Propeller 2",
    "revision": "Rev C",
    "clockFrequency": {
      "internal": 20000000,
      "crystal": 20000000,
      "maximum": 320000000
    },
    "packageTypes": ["100-pin TQFP", "64-pin QFN"]
  },
  "cogs": {
    "count": 8,
    "architecture": "symmetric",
    "memory": {
      "cogRam": 2048,
      "lutRam": 2048,
      "shared": true
    },
    "capabilities": [
      "Independent 32-bit processors",
      "2-clock instruction execution",
      "512 32-bit registers each",
      "Deterministic timing",
      "LUT sharing between COGs",
      "Hub round-robin access",
      "Inline PASM execution",
      "Non-destructive monitoring"
    ]
  },
  "hubMemory": {
    "size": 524288,
    "accessPattern": "round-robin",
    "bandwidth": "COGs access in round-robin slots, 8 clocks per cycle",
    "regions": [
      {
        "name": "Program Memory",
        "startAddress": "0x00000",
        "endAddress": "0x7FFFF",
        "purpose": "User program and data storage",
        "writable": true
      },
      {
        "name": "ROM Monitor",
        "startAddress": "0xF0000",
        "endAddress": "0xFFFFF",
        "purpose": "Built-in ROM monitor and boot code",
        "writable": false
      }
    ]
  },
  "smartPins": {
    "count": 64,
    "modes": [
      {
        "modeNumber": 0,
        "name": "Digital Input",
        "category": "digital",
        "description": "Simple digital input with optional pull-up/down"
      },
      {
        "modeNumber": 1,
        "name": "Digital Output",
        "category": "digital", 
        "description": "Simple digital output with drive control"
      },
      {
        "modeNumber": 2,
        "name": "Transition Counter",
        "category": "counter",
        "description": "Count positive/negative transitions"
      },
      {
        "modeNumber": 3,
        "name": "Duty Cycle Measurement",
        "category": "counter",
        "description": "Measure high/low time periods"
      },
      {
        "modeNumber": 4,
        "name": "Period Measurement",
        "category": "counter",
        "description": "Measure time between transitions"
      },
      {
        "modeNumber": 5,
        "name": "NCO Single-ended",
        "category": "pwm",
        "description": "Numerically controlled oscillator output"
      },
      {
        "modeNumber": 6,
        "name": "NCO Differential",
        "category": "pwm",
        "description": "Differential NCO output pair"
      },
      {
        "modeNumber": 7,
        "name": "PWM Triangle",
        "category": "pwm",
        "description": "Triangle wave PWM output"
      },
      {
        "modeNumber": 8,
        "name": "PWM Sawtooth",
        "category": "pwm",
        "description": "Sawtooth wave PWM output"
      },
      {
        "modeNumber": 9,
        "name": "Pulse/Cycle Output",
        "category": "pwm",
        "description": "Configurable pulse and cycle timing"
      },
      {
        "modeNumber": 10,
        "name": "Serial Transmit",
        "category": "serial",
        "description": "Asynchronous serial transmission"
      },
      {
        "modeNumber": 11,
        "name": "Serial Receive",
        "category": "serial",
        "description": "Asynchronous serial reception"
      },
      {
        "modeNumber": 12,
        "name": "SPI Master",
        "category": "serial",
        "description": "SPI master mode communication"
      },
      {
        "modeNumber": 13,
        "name": "SPI Slave",
        "category": "serial",
        "description": "SPI slave mode communication"
      },
      {
        "modeNumber": 14,
        "name": "Delta-Sigma DAC",
        "category": "analog",
        "description": "1-bit delta-sigma digital to analog conversion"
      },
      {
        "modeNumber": 15,
        "name": "Delta-Sigma ADC",
        "category": "analog",
        "description": "1-bit delta-sigma analog to digital conversion"
      }
    ],
    "configuration": {
      "registers": [
        {
          "name": "DIR",
          "bits": 32,
          "purpose": "Pin direction control (input/output)"
        },
        {
          "name": "OUT", 
          "bits": 32,
          "purpose": "Pin output state"
        },
        {
          "name": "IN",
          "bits": 32,
          "purpose": "Pin input state (read-only)"
        }
      ]
    }
  },
  "peripherals": {
    "cordic": {
      "functions": ["sine", "cosine", "tangent", "arctangent", "logarithm", "square root", "multiplication", "division"],
      "precision": "32-bit",
      "performance": "2-58 clock cycles depending on function"
    },
    "streamer": {
      "capabilities": ["DMA-like data movement", "Video signal generation", "Audio output", "Serial protocol generation"],
      "dataWidth": 32,
      "modes": ["NCO", "DDS", "DAC", "PWM", "Serial"]
    },
    "events": {
      "types": ["CT1", "CT2", "CT3", "SE1", "SE2", "SE3", "SE4", "PAT", "FBW", "XMT", "XFI", "XRO", "XRL", "ATN", "QMT"],
      "sources": ["System counters", "Smart pins", "Hub events", "COG events"],
      "polling": true,
      "interrupts": false
    }
  },
  "bootProcess": {
    "modes": [
      {
        "name": "Flash Boot",
        "pins": [61, 60],
        "description": "Boot from external flash memory",
        "priority": 1
      },
      {
        "name": "Serial Download", 
        "pins": [63, 62],
        "description": "Download program via serial connection",
        "priority": 2
      },
      {
        "name": "ROM Monitor",
        "pins": [],
        "description": "Start built-in ROM monitor/debugger",
        "priority": 3
      }
    ],
    "romContents": [
      "TAQOZ Forth interpreter",
      "Serial bootloader",
      "Clock configuration",
      "Pin setup utilities",
      "Debug interface"
    ]
  },
  "powerManagement": {
    "voltageRange": {
      "minimum": 1.8,
      "maximum": 3.6,
      "typical": 3.3
    },
    "powerModes": [
      {
        "name": "Active",
        "consumption": "Full operation, all COGs running",
        "wakeupSources": ["N/A"]
      },
      {
        "name": "Reduced",
        "consumption": "Some COGs stopped, reduced clock",
        "wakeupSources": ["Smart pin events", "Hub events"]
      },
      {
        "name": "Sleep",
        "consumption": "Minimal power, clock stopped",
        "wakeupSources": ["Pin transitions", "Reset"]
      }
    ]
  },
  "trustLevel": "verified",
  "sourceRefs": [
    {
      "document": "P2 Documentation v35",
      "section": "Architecture Overview"
    },
    {
      "document": "P2 Datasheet",
      "section": "Electrical Specifications"
    }
  ],
  "lastUpdated": "2025-08-15",
  "version": "1.0.0"
}